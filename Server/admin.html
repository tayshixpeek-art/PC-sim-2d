<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Global Admin Panel</title>
    <style>
        body { background-color: #000; color: #0f0; font-family: monospace; padding: 20px; }
        table { width: 100%; border: 1px solid #0f0; border-collapse: collapse; margin-top: 20px;}
        th, td { border: 1px solid #333; padding: 10px; text-align: left; }
        th { color: white; background: #111; }
    </style>
</head>
<body>
    <h1>SERVER USERS (REALTIME)</h1>
    <div id="loading">Загрузка данных из облака...</div>
    
    <table id="usersTable" style="display:none;">
        <thead>
            <tr>
                <th>Ник</th>
                <th>Пароль</th>
                <th>2FA</th>
                <th>Устройство</th>
                <th>Дата</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // --- ТВОИ КЛЮЧИ ---
        const firebaseConfig = {
          apiKey: "AIzaSyD-37EEdtFq2N4JXzbA8ndUtqBZ-ei4Gf8",
          authDomain: "pc-sim-2d.firebaseapp.com",
          databaseURL: "https://pc-sim-2d-default-rtdb.firebaseio.com",
          projectId: "pc-sim-2d",
          storageBucket: "pc-sim-2d.firebasestorage.app",
          messagingSenderId: "449307845492",
          appId: "1:449307845492:web:8e351324e1026f79fc4221"
        };
        // ------------------

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        const usersRef = ref(db, 'users');
        
        onValue(usersRef, (snapshot) => {
            const data = snapshot.val();
            const tbody = document.querySelector('#usersTable tbody');
            tbody.innerHTML = ""; 
            
            if (data) {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('usersTable').style.display = 'table';

                Object.keys(data).forEach(key => {
                    const user = data[key];
                    const twoFaDisplay = user.twoFa ? user.twoFa : "-";
                    const row = `
                        <tr>
                            <td style="color:white; font-weight:bold;">${key}</td>
                            <td style="color:yellow;">${user.password}</td>
                            <td style="color:cyan;">${twoFaDisplay}</td>
                            <td style="color:orange;">${user.device}</td>
                            <td style="color:grey;">${user.regDate}</td>
                        </tr>
                    `;
                    tbody.innerHTML += row;
                });
            } else {
                document.getElementById('loading').innerText = "База пуста.";
            }
        });
    </script>
</body>
</html>
